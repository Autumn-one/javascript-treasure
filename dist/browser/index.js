var test=function(e){"use strict";function t(e,t=null,n=null,r=!1){let i,o=e;return"number"==typeof t&&(r?(o=Promise.all([e,new Promise((e=>setTimeout(e,t)))]),i="all"):(o=Promise.allSettled([e,new Promise(((e,n)=>setTimeout(n,t)))]),i="allSettled")),"number"==typeof n&&(o=Promise.race([o,new Promise(((e,t)=>setTimeout((()=>t({type:"timeout",msg:"timeout error"})),n)))])),o.then((e=>"all"===i&&Array.isArray(e)?e[0]:"allSettled"===i&&Array.isArray(e)?e.find((e=>"fulfilled"===e.status))?.value:e))}function n(e,t=1e3){return"undefined"!=typeof requestIdleCallback?requestIdleCallback(e):setTimeout(e,t)}function r(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}return e.async_idle=function(e=1e3){return new Promise((t=>{n(t,e)}))},e.debounce=function(e,t,n="d",r){let i,o,u=0,l="timeout",a=!0;return"i-d"===n?function(...n){if(a)return a=!1,o=setTimeout((()=>a=!0),t),r&&r(),void e.apply(this,n);i&&clearTimeout(i),o&&clearTimeout(o),r&&r(),i=setTimeout((()=>{o=setTimeout((()=>a=!0),t),e.apply(this,n)}),t)}:"t-d"===n?function(...n){const o=+new Date;i&&clearTimeout(i);const a=o-u;if("immediate"!==l&&(a>=t||0==u))return u=o,l="immediate",r&&r(),void e.apply(this,n);"immediate"===l&&a>=t&&(r&&r(),i=setTimeout((()=>{u=o,l="timeout",e.apply(this,n)}),t))}:function(...n){i&&clearTimeout(i),r&&r(),i=setTimeout((()=>{e.apply(this,n)}),t)}},e.deep_equal=function e(t,n){if(null===t||null===n)return t===n;const i=Array.from(new Set([...Object.keys(t),...Object.keys(n)]));for(const o of i){const i=t[o],u=n[o],l=r(i)&&r(u);if((!["",void 0].includes(i)||!["",void 0].includes(u))&&(l&&!e(i,u)||!l&&i!==u))return!1}return!0},e.idle=n,e.is_object=r,e.pascal_to_kebab=function(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"")},e.promise_queue=async function(e,n=5e3){for(let i=0;i<e.length;i++){try{var r=await t(e[i],null,n)}catch(e){continue}return r}return Promise.reject("错误的 promise queue 调用")},e.promise_timeout=t,e.retry=async function(e,t){let n=0;const r=t?.times??1,i=t?.on_failed;for(;n<r;){try{var o=await e()}catch(e){n++,i?.(e,n);continue}break}return o},e.throttle=function(e,t){let n=0;return function(...r){const i=+new Date;let o;"number"==typeof t?o=t:(o=t.time,r.push(t)),(i-n>=o||0===n)&&(e.apply(this,r),n=i)}},e}({});
