"use strict";function e(e,t=null,r=null,o=!1){let n,i=e;return"number"==typeof t&&(o?(i=Promise.all([e,new Promise((e=>setTimeout(e,t)))]),n="all"):(i=Promise.allSettled([e,new Promise(((e,r)=>setTimeout(r,t)))]),n="allSettled")),"number"==typeof r&&(i=Promise.race([i,new Promise(((e,t)=>setTimeout((()=>t({type:"timeout",msg:"timeout error"})),r)))])),i.then((e=>"all"===n&&Array.isArray(e)?e[0]:"allSettled"===n&&Array.isArray(e)?e.find((e=>"fulfilled"===e.status))?.value:e))}function t(e,t=1e3){return"undefined"!=typeof requestIdleCallback?requestIdleCallback(e):setTimeout(e,t)}function r(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}exports.async_idle=function(e=1e3){return new Promise((r=>{t(r,e)}))},exports.debounce=function(e,t,r="d",o){let n,i,u=0,l="timeout",s=!0;return"i-d"===r?function(...r){if(s)return s=!1,i=setTimeout((()=>s=!0),t),o&&o(),void e.apply(this,r);n&&clearTimeout(n),i&&clearTimeout(i),o&&o(),n=setTimeout((()=>{i=setTimeout((()=>s=!0),t),e.apply(this,r)}),t)}:"t-d"===r?function(...r){const i=+new Date;n&&clearTimeout(n);const s=i-u;if("immediate"!==l&&(s>=t||0==u))return u=i,l="immediate",o&&o(),void e.apply(this,r);"immediate"===l&&s>=t&&(o&&o(),n=setTimeout((()=>{u=i,l="timeout",e.apply(this,r)}),t))}:function(...r){n&&clearTimeout(n),o&&o(),n=setTimeout((()=>{e.apply(this,r)}),t)}},exports.deep_equal=function e(t,o){if(null===t||null===o)return t===o;const n=Array.from(new Set([...Object.keys(t),...Object.keys(o)]));for(const i of n){const n=t[i],u=o[i],l=r(n)&&r(u);if((!["",void 0].includes(n)||!["",void 0].includes(u))&&(l&&!e(n,u)||!l&&n!==u))return!1}return!0},exports.idle=t,exports.is_object=r,exports.pascal_to_kebab=function(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"")},exports.promise_queue=async function(t,r=5e3){for(let n=0;n<t.length;n++){try{var o=await e(t[n],null,r)}catch(e){continue}return o}return Promise.reject("错误的 promise queue 调用")},exports.promise_timeout=e,exports.retry=async function(e,t){let r=0;const o=t?.times??1,n=t?.on_failed;for(;r<o;){try{var i=await e()}catch(e){r++,n?.(e,r);continue}break}return i},exports.throttle=function(e,t){let r=0;return function(...o){const n=+new Date;let i;"number"==typeof t?i=t:(i=t.time,o.push(t)),(n-r>=i||0===r)&&(e.apply(this,o),r=n)}};
